#! /bin/sh

#declare functions
function usage ()
{
   cat << EOF
Usage: $0 [-h] sdf-file
Parameters:
  -h           display this message
EOF
exit 0
}

function error ()
{
  echo error: $1
  exit 1
}

#process options
while getopts ":h" opt; do
   case $opt in
   \? ) usage;;
   h  ) usage;;
   esac
done
shift $(($OPTIND - 1))

#check validity of file argument
if [ $# -ne 1 ]; then usage; fi
if [ ! -e $1 ];  then error "file $1 does not exist"; fi

#parse sdf file
module=$(sed -e 's/\(.*\)\.[a-z0-9]*$/\1/' <<< $1)
pt-dump -m $module -o ${module}.tbl
if [ -e ${module}.tbl ]; then
  echo "wrote parse table to ${module}.tbl"
  exit 0
else
  exit 1
fi

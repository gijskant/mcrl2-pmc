HOST_OS            = "@HOST_OS@"

# Installation directories
prefix             = "@prefix@"
exec_prefix        = "@exec_prefix@"
bindir             = "@bindir@"
libdir             = "@libdir@"
datadir            = "@datarootdir@"
datarootdir        = "@datarootdir@"
includedir         = "@includedir@"
infodir            = "@infodir@"
mandir             = "@mandir@"

# Boost Build configuration
BJAM               = @BJAM@
BJAM_BUILD         = ./build.sh
ifeq ($(HOST_OS),WINDOWS)
BJAM_BUILD         = build.bat runtime-link=static link=static
endif

BOOST_BUILD       := $(BJAM) @BUILD_OPTIONS@

# Creates an application bundle on Mac OS X
.PHONY: all bjam install tools test

all: $(BJAM) config.status
	$(BOOST_BUILD)

install: $(BJAM) config.status
	$(BOOST_BUILD) --install

test: $(BJAM) config.status
	$(BJAM) ./status -l300 --enable-experimental --enable-deprecated --tool-tests

# Build boost build tool
bjam: $(BJAM)

$(BJAM):
	@mkdir -p build/bin
	@cd 3rd-party/boost/tools/jam; $(BJAM_BUILD)
	@rm -rf 3rd-party/boost/tools/jam/bootstrap

config.status: configure build/autoconf/config.jam.in
	$(error Update to configure detected, please run: ./config.status --recheck; ./config.status)

